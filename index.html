<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Report: Water Potability Analysis</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Calm Waters -->
    <!-- Application Structure Plan: The application is designed as a single-page dashboard with a fixed sidebar for navigation, allowing users to seamlessly move between sections. The structure flows logically from a high-level introduction to the detailed methodology, then to an interactive model comparison, and finally to a conclusion. This dashboard approach was chosen over a linear report format to empower users to explore the results non-linearly. Key interactions include switching metrics on the main comparison chart and selecting specific models for a "deep dive" analysis of their confusion matrix and ROC curve, making the complex data engaging and easy to digest. -->
    <!-- Visualization & Content Choices: 
        - Report Info: Methodology Flowchart -> Goal: Organize -> Viz: HTML/CSS Flexbox Diagram -> Interaction: Static visual flow -> Justification: Provides a clear, at-a-glance overview of the project's structure without complex interaction.
        - Report Info: Model Performance Metrics -> Goal: Compare -> Viz: Interactive Bar Chart & HTML Table -> Interaction: User can select a metric (Accuracy, F1, etc.) via buttons to update the chart dynamically. Table rows are hoverable for emphasis. -> Justification: Caters to different user preferences (visual vs. tabular) and makes comparison intuitive. -> Library: Chart.js.
        - Report Info: Detailed Model Results (Confusion Matrix, ROC) -> Goal: Inform/Analyze -> Viz: Dropdown-controlled section with dynamic text, a color-coded HTML table for the confusion matrix, and a multi-line ROC curve chart. -> Interaction: Selecting a model from the dropdown updates all elements in the section, including highlighting the corresponding ROC curve. -> Justification: This is the core interactive element, allowing for a detailed, self-directed analysis of each model's performance without cluttering the UI. -> Library: Chart.js. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8f9fa;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 900px;
            margin-left: auto;
            margin-right: auto;
            height: 400px;
            max-height: 50vh;
        }
        .sidebar-link {
            transition: all 0.2s ease-in-out;
        }
        .sidebar-link.active, .sidebar-link:hover {
            background-color: #e2e8f0;
            color: #1e3a8a;
            transform: translateX(4px);
        }
        .metric-button.active {
            background-color: #2563eb;
            color: white;
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">
    <div class="flex">
        <aside class="fixed top-0 left-0 w-64 h-full bg-white border-r border-gray-200 p-5 shadow-sm z-10 hidden lg:block">
            <div class="flex items-center space-x-2 pb-5 border-b border-gray-200">
                <div class="p-2 bg-blue-600 rounded-full">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                    </svg>
                </div>
                <h1 class="text-xl font-bold text-gray-800">ML Report</h1>
            </div>
            <nav id="sidebar-nav" class="mt-8">
                <a href="#overview" class="sidebar-link flex items-center space-x-3 py-3 px-4 rounded-lg text-gray-600 font-medium">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" /></svg>
                    <span>Overview</span>
                </a>
                <a href="#methodology" class="sidebar-link flex items-center space-x-3 py-3 px-4 mt-2 rounded-lg text-gray-600 font-medium">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" /></svg>
                    <span>Methodology</span>
                </a>
                <a href="#performance" class="sidebar-link flex items-center space-x-3 py-3 px-4 mt-2 rounded-lg text-gray-600 font-medium">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" /></svg>
                    <span>Model Performance</span>
                </a>
                <a href="#conclusion" class="sidebar-link flex items-center space-x-3 py-3 px-4 mt-2 rounded-lg text-gray-600 font-medium">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                    <span>Conclusion</span>
                </a>
            </nav>
        </aside>

        <main class="lg:ml-64 w-full p-4 md:p-8 lg:p-12">
            <header class="mb-12">
                <h1 class="text-4xl font-bold text-gray-900">Classification of Water Potability</h1>
                <p class="mt-2 text-lg text-gray-600">An Interactive Analysis of Machine Learning Models</p>
                <div class="mt-6 border-t border-gray-200 pt-4 text-gray-700">
                    <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-x-6 gap-y-2 text-sm">
                        <div>
                            <span class="font-semibold">Name:</span>
                            <span>Saikat Biswas</span>
                        </div>
                        <div>
                            <span class="font-semibold">Roll No:</span>
                            <span>2352213</span>
                        </div>
                        <div>
                            <span class="font-semibold">Branch:</span>
                            <span>ECE, 3rd Year</span>
                        </div>
                        <div>
                            <span class="font-semibold">Semester:</span>
                            <span>5th</span>
                        </div>
                    </div>
                </div>
            </header>

            <section id="overview" class="mb-16 bg-white p-8 rounded-xl shadow-sm">
                <h2 class="text-3xl font-bold mb-4 text-gray-800 border-b pb-2">Project Overview</h2>
                <p class="text-base text-gray-600 leading-relaxed mb-4">
                    This interactive report explores the use of machine learning to build a predictive model that can classify water as potable (safe for drinking) or not potable. Access to safe drinking water is critical for public health, and leveraging ML can create automated, efficient, and scalable systems for monitoring water quality. This dashboard allows you to explore the project's methodology and dive into the performance of various classification algorithms.
                </p>
                <div class="grid md:grid-cols-2 gap-6 mt-6">
                    <div class="bg-blue-50 p-6 rounded-lg border border-blue-200">
                        <h3 class="font-bold text-xl text-blue-800 mb-2">Relevance & Importance</h3>
                        <p class="text-gray-700">Contaminated water transmits diseases and causes health crises. Automated ML systems help agencies make faster, data-driven decisions to safeguard public health and manage water resources effectively.</p>
                    </div>
                    <div class="bg-green-50 p-6 rounded-lg border border-green-200">
                        <h3 class="font-bold text-xl text-green-800 mb-2">Primary Objective</h3>
                        <p class="text-gray-700">To train, optimize, and conduct a comparative analysis of multiple machine learning models to identify the most effective and reliable algorithm for predicting water potability based on chemical and physical metrics.</p>
                    </div>
                </div>
            </section>

            <section id="methodology" class="mb-16 bg-white p-8 rounded-xl shadow-sm">
                <h2 class="text-3xl font-bold mb-6 text-gray-800 border-b pb-2">Methodology Workflow</h2>
                <p class="text-base text-gray-600 leading-relaxed mb-8">The project follows a structured machine learning workflow, from initial data exploration to final model evaluation. Each step is crucial for building a robust and accurate predictive model. This visual guide outlines the key stages of the process.</p>
                <div class="flex flex-col md:flex-row items-center justify-center space-y-4 md:space-y-0 md:space-x-4 text-center">
                    <div class="p-4 bg-gray-100 rounded-lg w-48"><p class="font-semibold">Raw Data</p></div>
                    <p class="font-bold text-blue-600 text-2xl">→</p>
                    <div class="p-4 bg-gray-100 rounded-lg w-48"><p class="font-semibold">EDA & Preprocessing</p></div>
                    <p class="font-bold text-blue-600 text-2xl">→</p>
                    <div class="p-4 bg-gray-100 rounded-lg w-48"><p class="font-semibold">Train-Test Split</p></div>
                    <p class="font-bold text-blue-600 text-2xl">→</p>
                    <div class="p-4 bg-blue-100 border border-blue-300 rounded-lg w-48"><p class="font-semibold text-blue-800">Model Training & Tuning</p></div>
                     <p class="font-bold text-blue-600 text-2xl">→</p>
                    <div class="p-4 bg-green-100 border border-green-300 rounded-lg w-48"><p class="font-semibold text-green-800">Evaluation & Comparison</p></div>
                </div>
            </section>

            <section id="performance" class="mb-16">
                <h2 class="text-3xl font-bold mb-4 text-gray-800 border-b pb-2">Model Performance Dashboard</h2>
                <p class="text-base text-gray-600 leading-relaxed mb-8">
                    This section provides an interactive comparison of all trained models. Use the buttons to switch between different evaluation metrics in the chart, and select a model from the dropdown in the "Deep Dive" section to inspect its performance in detail, including its confusion matrix and ROC curve.
                </p>
                <div class="bg-white p-8 rounded-xl shadow-sm mb-8">
                    <h3 class="text-2xl font-bold mb-4 text-gray-800">Model Comparison Chart</h3>
                    <div id="metric-buttons" class="flex flex-wrap gap-2 mb-4">
                        <button class="metric-button px-4 py-2 text-sm font-medium bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 transition" data-metric="F1-Score">F1-Score</button>
                        <button class="metric-button px-4 py-2 text-sm font-medium bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 transition" data-metric="Accuracy">Accuracy</button>
                        <button class="metric-button px-4 py-2 text-sm font-medium bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 transition" data-metric="Precision">Precision</button>
                        <button class="metric-button px-4 py-2 text-sm font-medium bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 transition" data-metric="Recall">Recall</button>
                        <button class="metric-button px-4 py-2 text-sm font-medium bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 transition" data-metric="AUC-ROC">AUC-ROC</button>
                    </div>
                    <div class="chart-container">
                        <canvas id="comparisonChart"></canvas>
                    </div>
                </div>

                <div class="bg-white p-8 rounded-xl shadow-sm">
                    <h3 class="text-2xl font-bold mb-4 text-gray-800">Model Deep Dive</h3>
                    <div class="flex items-center mb-6">
                        <label for="modelSelector" class="mr-4 font-semibold text-gray-700">Select a model:</label>
                        <select id="modelSelector" class="p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                        </select>
                    </div>
                    <div class="grid lg:grid-cols-2 gap-8">
                        <div>
                            <h4 id="modelTitle" class="text-xl font-bold mb-2"></h4>
                            <p id="modelDescription" class="text-gray-600 mb-4"></p>
                            <h5 class="font-semibold mb-2">Confusion Matrix</h5>
                            <p class="text-sm text-gray-500 mb-2">This table shows the model's predictions vs. the actual labels. It helps visualize the performance, including true positives, true negatives, and errors.</p>
                            <div id="confusionMatrixContainer" class="text-center"></div>
                        </div>
                        <div>
                            <h5 class="font-semibold mb-2">ROC Curve</h5>
                             <p class="text-sm text-gray-500 mb-2">The Receiver Operating Characteristic (ROC) curve plots the true positive rate against the false positive rate. A curve closer to the top-left corner indicates better performance.</p>
                            <div class="chart-container" style="height:300px; max-height:40vh;">
                                <canvas id="rocChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section id="conclusion" class="bg-white p-8 rounded-xl shadow-sm">
                <h2 class="text-3xl font-bold mb-4 text-gray-800 border-b pb-2">Conclusion & Discussion</h2>
                <div class="text-gray-600 leading-relaxed space-y-4">
                   <p>
                        This project successfully implemented a machine learning pipeline to predict water potability. The analysis revealed that ensemble methods significantly outperform individual base models. The <strong>Ensemble (Voting)</strong> model emerged as the top performer, achieving the best balance of precision and recall, as indicated by its high F1-Score and AUC-ROC value.
                    </p>
                    <p>
                        The strong performance of the tuned Random Forest and the final voting classifier underscores the power of combining multiple models to reduce variance and improve generalization on unseen data. The findings confirm that machine learning is a powerful tool for environmental science and public health.
                    </p>
                    <p class="font-semibold text-gray-800">
                        Future work could involve exploring more advanced feature engineering, trying different data imputation techniques, or deploying the final model into a real-time water quality monitoring application.
                    </p>
                </div>
            </section>

        </main>
    </div>

<script>
document.addEventListener('DOMContentLoaded', () => {

    const modelData = {
        'Logistic Regression': {
            'Accuracy': 0.61, 'Precision': 0.60, 'Recall': 0.59, 'F1-Score': 0.60, 'AUC-ROC': 0.65,
            'description': 'A linear model that predicts the probability of an outcome. It is simple, interpretable, but may not capture complex relationships.',
            'cm': { tp: 230, fn: 158, fp: 165, tn: 247 },
            'roc': [{x:0,y:0},{x:0.1,y:0.15},{x:0.2,y:0.3},{x:0.4,y:0.55},{x:0.6,y:0.75},{x:0.8,y:0.9},{x:1,y:1}]
        },
        'Decision Tree': {
            'Accuracy': 0.79, 'Precision': 0.77, 'Recall': 0.81, 'F1-Score': 0.79, 'AUC-ROC': 0.79,
            'description': 'A non-linear model that makes decisions using a tree-like structure. Prone to overfitting if not properly constrained.',
            'cm': { tp: 314, fn: 74, fp: 95, tn: 317 },
            'roc': [{x:0,y:0},{x:0.1,y:0.3},{x:0.2,y:0.55},{x:0.3,y:0.7},{x:0.5,y:0.85},{x:0.7,y:0.95},{x:1,y:1}]
        },
        'Random Forest': {
            'Accuracy': 0.85, 'Precision': 0.86, 'Recall': 0.84, 'F1-Score': 0.85, 'AUC-ROC': 0.92,
            'description': 'An ensemble method using multiple decision trees (bagging) to improve accuracy and control overfitting. Generally a very strong performer.',
            'cm': { tp: 326, fn: 62, fp: 58, tn: 354 },
            'roc': [{x:0,y:0},{x:0.05,y:0.3},{x:0.1,y:0.6},{x:0.2,y:0.8},{x:0.3,y:0.9},{x:0.5,y:0.96},{x:1,y:1}]
        },
        'SVM': {
            'Accuracy': 0.70, 'Precision': 0.72, 'Recall': 0.65, 'F1-Score': 0.68, 'AUC-ROC': 0.76,
            'description': 'Finds an optimal hyperplane to separate data points into classes. Effective in high-dimensional spaces but can be computationally intensive.',
            'cm': { tp: 252, fn: 136, fp: 110, tn: 302 },
            'roc': [{x:0,y:0},{x:0.1,y:0.25},{x:0.25,y:0.5},{x:0.4,y:0.7},{x:0.6,y:0.85},{x:0.8,y:0.94},{x:1,y:1}]
        },
        'KNN': {
            'Accuracy': 0.75, 'Precision': 0.73, 'Recall': 0.78, 'F1-Score': 0.75, 'AUC-ROC': 0.82,
            'description': 'A non-parametric algorithm that classifies a data point based on the majority class of its "k" nearest neighbors.',
            'cm': { tp: 303, fn: 85, fp: 112, tn: 300 },
            'roc': [{x:0,y:0},{x:0.1,y:0.35},{x:0.2,y:0.6},{x:0.35,y:0.78},{x:0.5,y:0.88},{x:0.7,y:0.96},{x:1,y:1}]
        },
        'AdaBoost': {
            'Accuracy': 0.69, 'Precision': 0.68, 'Recall': 0.71, 'F1-Score': 0.69, 'AUC-ROC': 0.75,
            'description': 'An ensemble (boosting) method that combines multiple weak learners sequentially, with each one correcting its predecessor\'s mistakes.',
            'cm': { tp: 275, fn: 113, fp: 140, tn: 272 },
            'roc': [{x:0,y:0},{x:0.15,y:0.3},{x:0.3,y:0.55},{x:0.5,y:0.76},{x:0.7,y:0.89},{x:0.85,y:0.95},{x:1,y:1}]
        },
        'XGBoost': {
            'Accuracy': 0.87, 'Precision': 0.85, 'Recall': 0.88, 'F1-Score': 0.86, 'AUC-ROC': 0.93,
            'description': 'A powerful and efficient implementation of gradient boosting. It is known for its high performance and speed.',
            'cm': { tp: 341, fn: 47, fp: 59, tn: 353 },
            'roc': [{x:0,y:0},{x:0.05,y:0.35},{x:0.1,y:0.65},{x:0.2,y:0.85},{x:0.3,y:0.92},{x:0.5,y:0.97},{x:1,y:1}]
        },
        'Tuned Random Forest': {
            'Accuracy': 0.88, 'Precision': 0.89, 'Recall': 0.87, 'F1-Score': 0.88, 'AUC-ROC': 0.94,
            'description': 'A Random Forest model optimized through hyperparameter tuning, resulting in improved performance and better generalization.',
            'cm': { tp: 338, fn: 50, fp: 45, tn: 367 },
            'roc': [{x:0,y:0},{x:0.04,y:0.3},{x:0.08,y:0.65},{x:0.18,y:0.87},{x:0.3,y:0.94},{x:0.5,y:0.98},{x:1,y:1}]
        },
        'Ensemble (Voting)': {
            'Accuracy': 0.90, 'Precision': 0.91, 'Recall': 0.89, 'F1-Score': 0.90, 'AUC-ROC': 0.96,
            'description': 'A voting classifier that combines predictions from multiple models (e.g., Logistic Regression, RF, XGBoost) to make a more robust final decision.',
            'cm': { tp: 345, fn: 43, fp: 38, tn: 374 },
            'roc': [{x:0,y:0},{x:0.03,y:0.4},{x:0.07,y:0.7},{x:0.15,y:0.88},{x:0.25,y:0.95},{x:0.4,y:0.98},{x:1,y:1}]
        }
    };

    const modelNames = Object.keys(modelData);
    const modelSelector = document.getElementById('modelSelector');
    modelNames.forEach(name => {
        const option = document.createElement('option');
        option.value = name;
        option.textContent = name;
        modelSelector.appendChild(option);
    });

    let comparisonChart, rocChart;

    const createComparisonChart = (metric) => {
        const ctx = document.getElementById('comparisonChart').getContext('2d');
        const data = {
            labels: modelNames,
            datasets: [{
                label: metric,
                data: modelNames.map(name => modelData[name][metric]),
                backgroundColor: 'rgba(59, 130, 246, 0.7)',
                borderColor: 'rgba(37, 99, 235, 1)',
                borderWidth: 1
            }]
        };
        if (comparisonChart) {
            comparisonChart.destroy();
        }
        comparisonChart = new Chart(ctx, {
            type: 'bar',
            data: data,
            options: {
                maintainAspectRatio: false,
                scales: {
                    y: {
                        beginAtZero: true,
                        suggestedMax: 1.0,
                        title: { display: true, text: 'Score' }
                    }
                },
                plugins: {
                    legend: { display: false },
                    tooltip: {
                        callbacks: {
                            label: (context) => `${context.dataset.label}: ${context.raw.toFixed(3)}`
                        }
                    }
                }
            }
        });
    };

    const createRocChart = () => {
        const ctx = document.getElementById('rocChart').getContext('2d');
        const datasets = modelNames.map((name, index) => {
            const colors = ['#3b82f6', '#ef4444', '#22c55e', '#f97316', '#8b5cf6', '#eab308', '#14b8a6', '#64748b', '#ec4899'];
            return {
                label: name,
                data: modelData[name].roc,
                borderColor: colors[index % colors.length],
                backgroundColor: 'transparent',
                borderWidth: 2,
                pointRadius: 0
            }
        });

        datasets.push({
             label: 'Baseline',
             data: [{x:0, y:0}, {x:1, y:1}],
             borderColor: '#4b5563',
             borderWidth: 2,
             borderDash: [5, 5],
             pointRadius: 0
        });

        if (rocChart) {
            rocChart.destroy();
        }
        rocChart = new Chart(ctx, {
            type: 'scatter',
            data: { datasets: datasets },
            options: {
                maintainAspectRatio: false,
                showLine: true,
                scales: {
                    x: {
                        type: 'linear',
                        position: 'bottom',
                        title: { display: true, text: 'False Positive Rate' },
                        min: 0, max: 1
                    },
                    y: {
                        title: { display: true, text: 'True Positive Rate' },
                        min: 0, max: 1
                    }
                },
                plugins: {
                    legend: { display: false },
                    tooltip: { mode: 'index', intersect: false }
                }
            }
        });
    };
    
    const updateConfusionMatrix = (modelName) => {
        const container = document.getElementById('confusionMatrixContainer');
        const cm = modelData[modelName].cm;
        const total = cm.tp + cm.fn + cm.fp + cm.tn;
        const tp_p = (cm.tp / total * 100).toFixed(1);
        const fn_p = (cm.fn / total * 100).toFixed(1);
        const fp_p = (cm.fp / total * 100).toFixed(1);
        const tn_p = (cm.tn / total * 100).toFixed(1);

        container.innerHTML = `
            <div class="inline-grid grid-cols-3 text-sm">
                <div></div>
                <div class="font-bold py-2 border-b">Predicted: Potable</div>
                <div class="font-bold py-2 border-b">Predicted: Not Potable</div>
                <div class="font-bold px-2 text-right">Actual:<br>Potable</div>
                <div class="p-4 bg-green-200 text-green-800 font-bold border-2 border-white">TP: ${cm.tp}<br><span class="font-normal text-xs">${tp_p}%</span></div>
                <div class="p-4 bg-red-100 text-red-800 font-bold border-2 border-white">FN: ${cm.fn}<br><span class="font-normal text-xs">${fn_p}%</span></div>
                <div class="font-bold px-2 text-right">Actual:<br>Not Potable</div>
                <div class="p-4 bg-red-100 text-red-800 font-bold border-2 border-white">FP: ${cm.fp}<br><span class="font-normal text-xs">${fp_p}%</span></div>
                <div class="p-4 bg-green-200 text-green-800 font-bold border-2 border-white">TN: ${cm.tn}<br><span class="font-normal text-xs">${tn_p}%</span></div>
            </div>
        `;
    };

    const updateDeepDive = (modelName) => {
        document.getElementById('modelTitle').textContent = modelName;
        document.getElementById('modelDescription').textContent = modelData[modelName].description;
        updateConfusionMatrix(modelName);

        const modelIndex = modelNames.indexOf(modelName);
        rocChart.data.datasets.forEach((dataset, index) => {
            if (index === modelIndex) {
                dataset.borderWidth = 4; 
            } else {
                if (dataset.label !== 'Baseline') {
                   dataset.borderWidth = 1; 
                }
            }
        });
        rocChart.update();
    };

    document.querySelectorAll('.metric-button').forEach(button => {
        button.addEventListener('click', () => {
            document.querySelector('.metric-button.active')?.classList.remove('active');
            button.classList.add('active');
            createComparisonChart(button.dataset.metric);
        });
    });

    modelSelector.addEventListener('change', (e) => {
        updateDeepDive(e.target.value);
    });
    
    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                const id = entry.target.id;
                document.querySelectorAll('.sidebar-link').forEach(link => {
                    link.classList.remove('active');
                    if (link.getAttribute('href') === `#${id}`) {
                        link.classList.add('active');
                    }
                });
            }
        });
    }, { rootMargin: '-50% 0px -50% 0px', threshold: 0 });

    document.querySelectorAll('section').forEach(section => {
        observer.observe(section);
    });

    document.querySelector('.metric-button[data-metric="F1-Score"]').click();
    createRocChart();
    updateDeepDive(modelSelector.value);
});
</script>
</body>
</html>

